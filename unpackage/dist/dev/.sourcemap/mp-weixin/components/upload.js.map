{"version":3,"sources":[null,"webpack:///D:/wokespace/cloud/ruoyi-app/components/upload.vue?de91","webpack:///D:/wokespace/cloud/ruoyi-app/components/upload.vue?8339","webpack:///D:/wokespace/cloud/ruoyi-app/components/upload.vue?c26c","uni-app:///components/upload.vue"],"names":["data","entity","isArray","list","vm","triggered","props","count","type","default","action","value","size","readonly","model","prop","event","name","title","watch","created","utils","methods","onInitValue","onChange","onRemove","onUploaded","onUpload","uni","sizeType","sourceType","success","url","path","doUpload","formData","$","cache","processData","contentType","error","console"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;;;AAGrD;AACyL;AACzL,gBAAgB,gMAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACzBA;AAAA;AAAA;AAAA;AAAosB,CAAgB,+sBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACyBxtB;;;;;;;;;;;;;;;;;;;;;;;;;eACA;EACAA;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;IACA;IACAG;MACAH;IACA;IACAI;MACAJ;MACAC;IACA;IACAI;MACAL;IACA;EACA;EACAM;IACAC;IACAC;EACA;EACAC;EACAC;EACAC;IACAR;MACA;QACA;MACA;IACA;EACA;EACAS;IACAC;IACA;EACA;EACAC;IACAC;MACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;QACA;QACA;UACA;QACA;MACA;MACA;MACA;MACA;QACAvB;MACA;MACA;IACA;IACAwB;MAAA;MACA;QACA;MACA;MACAC;QACArB;QAAA;QACAsB;QAAA;QACAC;QAAA;QACAC;UACA;UACA;YACAV;cACAW;cACAC;cACAF;gBACA;gBACA;cACA;YACA;UACA;QACA;MACA;IACA;IACAG;MAAA;MACA;MACA;MACA;MACAC;MACAC;QACAJ;QAAA;QACAxB;QACA6B;QAAA;QACArC;QACAsC;QAAA;QACAC;QAAA;QACAR;UACA;YACA;UACA;QACA;QACAS;UACAC;QACA;MACA;IACA;EACA;AACA;AAAA,2B","file":"components/upload.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./upload.vue?vue&type=template&id=1f6e267c&\"\nvar renderjs\nimport script from \"./upload.vue?vue&type=script&lang=js&\"\nexport * from \"./upload.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/upload.vue\"\nexport default component.exports","export * from \"-!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=template&id=1f6e267c&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = Number(_vm.size || 80)\n  var m1 = Number(_vm.size || 80)\n  var g0 = _vm.list.length == 0 || _vm.count > 1\n  var m2 = g0 ? Number(_vm.size || 80) : null\n  var m3 = g0 ? Number(_vm.size || 80) : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n        m1: m1,\n        g0: g0,\n        m2: m2,\n        m3: m3,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\JS\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"ux-flex\" :class=\"count==1?'c':'l'\" style=\"width:100%;padding: 2px;\">\r\n\t\t<view v-for=\"(item,index) in list\" test=\"false\" class=\"e c\" :style=\"{width:(Number(size||80)+4)+'px',height:(Number(size||80)+4)+'px'}\" style=\"position: relative;\">\r\n\t\t\t<view :style=\"{width:(size||80)+'px',height:(size||80)+'px'}\" style=\"width:80px;height:80px; flex-flow: column;\" class=\"c t\">\r\n\t\t\t\t<img border=\"0\" :src=\"item\" style=\"width:100%;height:100%;\" @click=\"onUpload(index)\">\r\n\t\t\t\t<view v-if=\"count>1\" style=\"position:absolute;width:36rpx;height:36rpx;top:-9px;z-index:1;background-color:#E33731;border-radius:180rpx;right:-9px;\" class=\"e c\" @click=\"onRemove(index)\">\r\n\t\t\t\t\t<icon class=\"iconfont icon-close\" style=\"color:#ffffff;font-size:22rpx;border-radius:180rpx;\"></icon>\r\n\t\t\t\t</view>\r\n\t\t\t\t<input v-if=\"count==1 && (vm.platform=='DUTE'||vm.platform=='H5')\" @change=\"doUpload\" accept=\"image/*\" type=\"file\" style=\"border:0px;width:100%;height:100%;background:transparent;position:absolute;z-index:9;top:0px;left:0px;opacity:0;\">\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view v-if=\"list.length==0 || count>1\" class=\"e c\" :style=\"{width:(Number(size||80)+4)+'px',height:(Number(size||80)+4)+'px'}\" style=\"position: relative;\">\r\n\t\t\t<view v-if=\"!readonly\" :style=\"{width:(size||80)+'px',height:(size||80)+'px'}\" style=\"width:80px;height:80px; border:1px dashed #D2D0D0;flex-flow: column;\" class=\"c t ux-flex\" @click=\"onUpload()\">\r\n\t\t\t\t<view class=\"fixe c e\" style=\"min-width:100%;flex:1;\">\r\n\t\t\t\t\t<icon class=\"iconfont icon-cameraadd\" :style=\"{'font-size':(size||80)/3+'px'}\" style=\"font-size: 28px;color: rgb(153, 153, 153);\" type=\"\"></icon>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view style=\"min-width:100%;height:30px;\" class=\"c t\">\r\n\t\t\t\t\t<text style=\"font-size: 24rpx; color: rgb(153, 153, 153);\">上传图片</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<input v-if=\"vm.platform=='DUTE'||vm.platform=='H5'\" @change=\"doUpload\" accept=\"image/*\" type=\"file\" style=\"border:0px;width:100%;height:100%;background:transparent;position:absolute;z-index:9;top:0px;left:0px;opacity:0;\">\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n<script type=\"module\">\r\nimport utils from \"../lib/utils.js\";\r\nexport default{\r\n\tdata(){\r\n\t\treturn {\r\n\t\t\tentity:{},\r\n\t\t\tisArray:false,\r\n\t\t\tlist:[],\r\n\t\t\tvm:{},\r\n\t\t\ttriggered:true,\r\n\t\t}\r\n\t},\r\n\tprops:{\r\n\t\tcount:{\r\n\t\t\ttype:Number,\r\n\t\t\tdefault:1,\r\n\t\t},\r\n\t\taction:{\r\n\t\t\ttype:String,\r\n\t\t},\r\n\t\tvalue:{\r\n\t\t\ttype:[Number,String],\r\n\t\t},\r\n\t\tsize:{\r\n\t\t\ttype:Number,\r\n\t\t\tdefault:80,\r\n\t\t},\r\n\t\treadonly:{\r\n\t\t\ttype:Boolean\r\n\t\t}\r\n\t},\r\n\tmodel:{\r\n\t\tprop:\"value\",\r\n\t\tevent:\"change\",\r\n\t},\r\n\tname:\"upload\",\r\n\ttitle:\"图片上传\",\r\n\twatch:{\r\n\t\tvalue(value){\r\n\t\t\tif(!this.list||!this.list.length){\r\n\t\t\t\tthis.onInitValue(value);\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\tcreated:function(options){\r\n\t\tutils._init(this,{},true);\r\n\t\tthis.onInitValue(this.value);\r\n\t},\r\n\tmethods:{\r\n\t\tonInitValue:function(value){\r\n\t\t\tif(value){\r\n\t\t\t\tif(Array.isArray(value)){\r\n\t\t\t\t\tthis.list = value;\r\n\t\t\t\t\tthis.isArray = true;\r\n\t\t\t\t}else if(value.startsWith(\"[\")){\r\n\t\t\t\t\tthis.list = JSON.parse(value);\r\n\t\t\t\t\tthis.isArray = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.list = value.split(\",\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonChange:function(){\r\n\t\t\tif(this.isArray){\r\n\t\t\t\tthis.$emit(\"input\", this.list);\r\n\t\t\t\tthis.$emit(\"change\", this.list);\r\n\t\t\t}else{\r\n\t\t\t\tthis.$emit(\"input\", this.list.join(\",\"));\r\n\t\t\t\tthis.$emit(\"change\", this.list.join(\",\"));\r\n\t\t\t}\r\n\t\t},\r\n\t\tonRemove:function(index){\r\n\t\t\tthis.list.splice(index,1);\r\n\t\t\tthis.onChange();\r\n\t\t},\r\n\t\tonUploaded:function(url,index){\r\n\t\t\tif(typeof(index)!=\"undefined\"){\r\n\t\t\t\tthis.list[index] = url;\r\n\t\t\t}else{\r\n\t\t\t\tthis.list.push(url);\r\n\t\t\t\tif(this.list.length>this.count){\r\n\t\t\t\t\tthis.list.splice(0,this.list.length-this.count);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar list = this.list;\r\n\t\t\tthis.list = null;\r\n\t\t\tthis.setData({\r\n\t\t\t\tlist:list\r\n\t\t\t});\r\n\t\t\tthis.onChange();\r\n\t\t},\r\n\t\tonUpload:function(index){\r\n\t\t\tif(this.readonly){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tcount: this.count||1, //默认9\r\n\t\t\t\tsizeType: ['original', 'compressed'], //可以指定是原图还是压缩图，默认二者都有\r\n\t\t\t\tsourceType: ['album',\"camera\"], //album 从相册选图，camera 使用相机，默认二者都有。如需直接开相机或直接选相册，请只使用一个选项\r\n\t\t\t\tsuccess: (res)=>{\r\n\t\t\t\t\t//res.tempFilePaths 图片的本地文件路径列表\r\n\t\t\t\t\tfor(var o in res.tempFilePaths){\r\n\t\t\t\t\t\tutils.upload({\r\n\t\t\t\t\t\t\turl: this.action || \"/api/lib/upload.vo\",\r\n\t\t\t\t\t\t\tpath:res.tempFilePaths[o],\r\n\t\t\t\t\t\t\tsuccess:(protocol)=>{\r\n\t\t\t\t\t\t\t\t//返回图片地址为：protocol.data.url\r\n\t\t\t\t\t\t\t\tthis.onUploaded(protocol.url,index);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tdoUpload(e){\r\n\t\t\tvar config = this.getConfig();\r\n\t\t\tvar imgFile = e.target.files[0]; //获取图片文件\r\n\t\t\tvar formData = new FormData();  // 创建form对象\r\n\t\t\tformData.append('file', imgFile);  // 通过append向form对象添加数据\r\n\t\t\t$.ajax({\r\n\t\t\t    url: this.action , //请求的接口地址\r\n\t\t\t    type: 'POST',\r\n\t\t\t    cache: false, //上传文件不需要缓存\r\n\t\t\t    data: formData,\r\n\t\t\t    processData: false, // 不要去处理发送的数据\r\n\t\t\t    contentType: false, // 不要去设置Content-Type请求头\r\n\t\t\t    success: (protocol)=>{\r\n\t\t\t        if(protocol.success){\r\n\t\t\t\t\t\tthis.onUploaded(protocol.data.url);\r\n\t\t\t\t\t}\r\n\t\t\t    },\r\n\t\t\t    error: function(err){\r\n\t\t\t        console.log(err)\r\n\t\t\t    }\r\n\t\t\t})\r\n\t\t}\r\n\t},\r\n}\r\n</script>\r\n"],"sourceRoot":""}